{
  "schema_version": "1.0.0",
  "command": "capsh",
  "description": "capsh - capability shell wrapper",
  "global_flags": [
    {
      "short": null,
      "long": "--addamb",
      "value_type": "String",
      "takes_value": true,
      "description": "add xxx,... capabilities to ambient set",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--cap-uid",
      "value_type": "String",
      "takes_value": true,
      "description": "the  cap_setuid(3)  function  to set the UID of the current process. This performs all  preparations  for  setting  the  UID without  dropping  capabilities  in  the process. Following this command the prevailing effective capabilities will be lowered.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--caps",
      "value_type": "String",
      "takes_value": true,
      "description": "those  specified  by cap-set.   Where  cap-set is a text-representation of capability state as per cap_from_text(3).",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--chroot",
      "value_type": "File",
      "takes_value": true,
      "description": "the  chroot(2)  system call with the new root-directory (/) equal to path.  This operation requires CAP_SYS_CHROOT to be in effect.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--current",
      "value_type": "String",
      "takes_value": true,
      "description": "prevailing  capability  state,  1e capabilities and IAB vector.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--decode",
      "value_type": "String",
      "takes_value": true,
      "description": "is  a  convenience  feature. If you look at /proc/1/status there are some capability related fields of the following form:",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--delamb",
      "value_type": "String",
      "takes_value": true,
      "description": "the  specified  ambient  capability  from  the  running process.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--drop",
      "value_type": "String",
      "takes_value": true,
      "description": "capabilities  as recognized by the cap_from_name(3) function. Use of this feature requires  that capsh is operating with CAP_SETPCAP in its effec‐ tive set.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--explain",
      "value_type": "Number",
      "takes_value": true,
      "description": "the  speci‐ fied  capability makes available to a running program. Note, in‐ stead of cap_xxx, one can provide a  decimal  number  and  capsh will look up the corresponding capability's description.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--forkfor",
      "value_type": "String",
      "takes_value": true,
      "description": "for  so many  seconds. The child will sleep that long and then exit with status 0. The purpose of this command is  to  support  exploring the  way  processes  are  killable  in  the  face  of capability changes. See the --killit command. Only one fork can  be  active at a time.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--gid",
      "value_type": "String",
      "takes_value": true,
      "description": "id  using  the  setgid(2)  system call.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--groups",
      "value_type": "String",
      "takes_value": true,
      "description": null,
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--has-a",
      "value_type": "String",
      "takes_value": true,
      "description": "xxx raised.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--has-ambient",
      "value_type": "Bool",
      "takes_value": false,
      "description": "a  check to see if the running kernel supports ambient capabilities. If not, capsh exits with status 1.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--has-b",
      "value_type": "String",
      "takes_value": true,
      "description": "exit 1 if capability xxx not dropped",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--has-i",
      "value_type": "String",
      "takes_value": true,
      "description": "exit 1 if capability xxx not inheritable",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--has-no-new-privs",
      "value_type": "Bool",
      "takes_value": false,
      "description": "exit 1 if privs not limited",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--has-p",
      "value_type": "String",
      "takes_value": true,
      "description": "vector  has  capability xxx raised.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--help",
      "value_type": "Bool",
      "takes_value": false,
      "description": "this message (or try 'man capsh')",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--iab",
      "value_type": "String",
      "takes_value": true,
      "description": "text    conventions   used   for   xxx   are   those   of cap_iab_from_text(3).",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--inh",
      "value_type": "String",
      "takes_value": true,
      "description": "process to  equal  those  provided in the comma separated list. For this action to succeed, the prevailing process  should  already  have each of these capabilities in the union of the current inherita‐ ble  and permitted capability sets, or capsh should be operating with CAP_SETPCAP in its effective set.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--inmode",
      "value_type": "String",
      "takes_value": true,
      "description": null,
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--is-gid",
      "value_type": "String",
      "takes_value": true,
      "description": "exit 1 if gid != <n>",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--is-uid",
      "value_type": "String",
      "takes_value": true,
      "description": "exit 1 if uid != <n>",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--keep",
      "value_type": "String",
      "takes_value": true,
      "description": "to  the super-user. However, it is normally the case that when the super-user changes UID to some lesser user, then  capa‐ bilities  are dropped. For these situations, the kernel can per‐ mit the process to retain its  capabilities  after  a  setuid(2) system call. This feature is known as keep-caps support. The way to activate it using this program is with this argument. Setting the  value to 1 will cause keep-caps to be active. Setting it to 0 will cause keep-caps to deactivate for the current process. In all cases, keep-caps is deactivated when an exec() is performed. See --secbitsand--mode for ways to disable this feature.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--killit",
      "value_type": "String",
      "takes_value": true,
      "description": "commands  causes a --forkfor child to be kill(2)d with the specified signal. The command then waits for the child to  exit. If  the exit status does not match the signal being used to kill it, the capsh program exits with status 1.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--license",
      "value_type": "Bool",
      "takes_value": false,
      "description": "display license info",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--mode",
      "value_type": "Bool",
      "takes_value": false,
      "description": "the   prevailing   libcap   mode  as  guessed  by  the cap_get_mode(3) function.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--modes",
      "value_type": "String",
      "takes_value": true,
      "description": "list libcap named modes",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--no-new-privs",
      "value_type": "Bool",
      "takes_value": false,
      "description": null,
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--noamb",
      "value_type": "Bool",
      "takes_value": false,
      "description": "reset (drop) all ambient capabilities",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--noenv",
      "value_type": "String",
      "takes_value": true,
      "description": "no fixup of env vars (for --user)",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--print",
      "value_type": "Bool",
      "takes_value": false,
      "description": "display capability relevant state",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--quiet",
      "value_type": "Bool",
      "takes_value": false,
      "description": "suppresses  the  capsh  runtime check to confirm the running libcap is recent enough that it can name all of the kernel  sup‐ ported capability values.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--secbits",
      "value_type": "File",
      "takes_value": true,
      "description": "This is done  using  the prctl(2)  PR_SET_SECUREBITS  operation.   The  list of supported bits and their meaning  can  be  found  in  the  <sys/secbits.h> header  file.  The  program will list these bits via the --print command.  The argument is expressed as a numeric bitmask, in any of the formats permitted by strtoul(3).  An alternative to  this bit-twiddling is embedded in the --mode* commandline arguments.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--shell",
      "value_type": "Number",
      "takes_value": true,
      "description": "option changes the shell that is invoked when the argument == is encountered.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--strict",
      "value_type": "Number",
      "takes_value": true,
      "description": "subsequent  attempts  to fixup --caps= and --inh= arguments. That is, when the prevailing Effective flag does not contain CAP_SETPCAP the to be raised In‐ heritable  Flag  values (in strict mode) are limited to those in the Permitted set. The strict mode defaults  to  off.  Supplying this  argument an even number of times restores this default be‐ havior.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--suggest",
      "value_type": "String",
      "takes_value": true,
      "description": "to capsh, and display all descriptions that include phrase.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--supports",
      "value_type": "String",
      "takes_value": true,
      "description": "option can  be used to verify the existence of a capability on the sys‐ tem. For example,  --supports=cap_syslog  will  cause  capsh  to promptly  exit  with  a  status  of 1 when run on kernel 2.6.27. However, when run on kernel 2.6.38 it will silently succeed.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--uid",
      "value_type": "String",
      "takes_value": true,
      "description": "all  UID  values  to  equal id using the setuid(2) system call. This argument may require explicit preparation of the  ef‐ fective set.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    },
    {
      "short": null,
      "long": "--user",
      "value_type": "String",
      "takes_value": true,
      "description": "That  is,  look  up  the user's  UID and GID with getpwuid(3) and their group memberships with getgrouplist(3) and set them all  using  cap_setuid(3)  and cap_setgroups(3).   Following  this command, the effective capa‐ bilities will be cleared, but the permitted set will not be,  so the running program is still privileged.",
      "multiple": false,
      "conflicts_with": [],
      "requires": []
    }
  ],
  "subcommands": [],
  "positional": [],
  "source": "Merged",
  "confidence": 0.8,
  "version": null
}